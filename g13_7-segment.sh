#!/bin/bash

# Copyright (C) 2011-2012 by Doc. Smimble
# 
# 7-Segment Clock v0.1 for ecraven's G13 Program. 
#
#
#
# This program is free software; you can redistribute it and/or modify it
# under the terms of the GNU General Public License as published by the
# Free Software Foundation; either version 2, or (at your option) any
# later version.
#
# This program is distributed in the hope that it will be useful,
# but WITHOUT ANY WARRANTY; without even the implied warranty of
# MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
# GNU General Public License for more details.
#
# You should have received a copy of the GNU General Public License
# along with this program; if not, write to the Free Software
# Foundation, Inc., 59 Temple Place - Suite 330, Boston, MA  02111-1307, USA
# 
# [!] Special Thanks to ecraven for the Basic Code from his clock script. 

# Install
# -------
# 1. Copy this script in the same folder where is the g13 daemon and the program pbm2lpbm. 


function get_time {
get_time_2=`date +%H-%M-%S`;
#-# Debug
#-#get_time_2="57-89-00"
echo "Time: $get_time_2"
echo ""
}

postparams_begin='-pointsize 10 '
postparams_data=''
postparams_end=' pbm:-'


function SEGMENT_0 { echo '
-draw "line '$((${1}+0))','$((${2}+2))' '$((${1}+0))','$((${2}+6))'"
-draw "line '$((${1}+1))','$((${2}+1))' '$((${1}+1))','$((${2}+7))'"
-draw "line '$((${1}+2))','$((${2}+0))' '$((${1}+2))','$((${2}+8))'"
-draw "line '$((${1}+0))','$((${2}+10))' '$((${1}+0))','$((${2}+14))'"
-draw "line '$((${1}+1))','$((${2}+9))' '$((${1}+1))','$((${2}+15))'"
-draw "line '$((${1}+2))','$((${2}+8))' '$((${1}+2))','$((${2}+16))'"
-draw "line '$((${1}-6))','$((${2}+15))' '$((${1}-2))','$((${2}+15))'"
-draw "line '$((${1}-7))','$((${2}+16))' '$((${1}-1))','$((${2}+16))'"
-draw "line '$((${1}-8))','$((${2}+17))' '$((${1}-0))','$((${2}+17))'"
-draw "line '$((${1}-8))','$((${2}+10))' '$((${1}-8))','$((${2}+14))'"
-draw "line '$((${1}-9))','$((${2}+9))' '$((${1}-9))','$((${2}+15))'"
-draw "line '$((${1}-10))','$((${2}+8))' '$((${1}-10))','$((${2}+16))'"
-draw "line '$((${1}-8))','$((${2}+2))' '$((${1}-8))','$((${2}+6))'"
-draw "line '$((${1}-9))','$((${2}+1))' '$((${1}-9))','$((${2}+7))'"
-draw "line '$((${1}-10))','$((${2}+0))' '$((${1}-10))','$((${2}+8))'"
-draw "line '$((${1}-6))','$((${2}+1))' '$((${1}-2))','$((${2}+1))'"
-draw "line '$((${1}-7))','$((${2}+0))' '$((${1}-1))','$((${2}+0))'"
-draw "line '$((${1}-8))','$((${2}-1))' '$((${1}-0))','$((${2}-1))'"
'
}

function SEGMENT_1 { echo '
-draw "line '$((${1}+0))','$((${2}+2))' '$((${1}+0))','$((${2}+6))'"
-draw "line '$((${1}+1))','$((${2}+1))' '$((${1}+1))','$((${2}+7))'"
-draw "line '$((${1}+2))','$((${2}+0))' '$((${1}+2))','$((${2}+8))'"
-draw "line '$((${1}+0))','$((${2}+10))' '$((${1}+0))','$((${2}+14))'"
-draw "line '$((${1}+1))','$((${2}+9))' '$((${1}+1))','$((${2}+15))'"
-draw "line '$((${1}+2))','$((${2}+8))' '$((${1}+2))','$((${2}+16))'"
'
}

function SEGMENT_2 { echo '
-draw "line '$((${1}+0))','$((${2}+2))' '$((${1}+0))','$((${2}+6))'"
-draw "line '$((${1}+1))','$((${2}+1))' '$((${1}+1))','$((${2}+7))'"
-draw "line '$((${1}+2))','$((${2}+0))' '$((${1}+2))','$((${2}+8))'"
-draw "line '$((${1}-8))','$((${2}+7))' '$((${1}-2))','$((${2}+7))'"
-draw "line '$((${1}-7))','$((${2}+8))' '$((${1}-1))','$((${2}+8))'"
-draw "line '$((${1}-6))','$((${2}+9))' '$((${1}-0))','$((${2}+9))'"
-draw "line '$((${1}-6))','$((${2}+15))' '$((${1}-1))','$((${2}+15))'"
-draw "line '$((${1}-7))','$((${2}+16))' '$((${1}-0))','$((${2}+16))'"
-draw "line '$((${1}-8))','$((${2}+17))' '$((${1}+1))','$((${2}+17))'"
-draw "line '$((${1}-8))','$((${2}+10))' '$((${1}-8))','$((${2}+14))'"
-draw "line '$((${1}-9))','$((${2}+9))' '$((${1}-9))','$((${2}+15))'"
-draw "line '$((${1}-10))','$((${2}+8))' '$((${1}-10))','$((${2}+16))'"
-draw "line '$((${1}-7))','$((${2}+1))' '$((${1}-2))','$((${2}+1))'"
-draw "line '$((${1}-8))','$((${2}+0))' '$((${1}-1))','$((${2}+0))'"
-draw "line '$((${1}-9))','$((${2}-1))' '$((${1}-0))','$((${2}-1))'"
'
}

function SEGMENT_3 { echo '
-draw "line '$((${1}+0))','$((${2}+2))' '$((${1}+0))','$((${2}+6))'"
-draw "line '$((${1}+1))','$((${2}+1))' '$((${1}+1))','$((${2}+7))'"
-draw "line '$((${1}+2))','$((${2}+0))' '$((${1}+2))','$((${2}+8))'"
-draw "line '$((${1}-6))','$((${2}+7))' '$((${1}-2))','$((${2}+7))'"
-draw "line '$((${1}-7))','$((${2}+8))' '$((${1}-1))','$((${2}+8))'"
-draw "line '$((${1}-6))','$((${2}+9))' '$((${1}-2))','$((${2}+9))'"
-draw "line '$((${1}+0))','$((${2}+10))' '$((${1}+0))','$((${2}+14))'"
-draw "line '$((${1}+1))','$((${2}+9))' '$((${1}+1))','$((${2}+15))'"
-draw "line '$((${1}+2))','$((${2}+8))' '$((${1}+2))','$((${2}+16))'"
-draw "line '$((${1}-7))','$((${2}+15))' '$((${1}-2))','$((${2}+15))'"
-draw "line '$((${1}-8))','$((${2}+16))' '$((${1}-1))','$((${2}+16))'"
-draw "line '$((${1}-9))','$((${2}+17))' '$((${1}-0))','$((${2}+17))'"
-draw "line '$((${1}-7))','$((${2}+1))' '$((${1}-2))','$((${2}+1))'"
-draw "line '$((${1}-8))','$((${2}+0))' '$((${1}-1))','$((${2}+0))'"
-draw "line '$((${1}-9))','$((${2}-1))' '$((${1}-0))','$((${2}-1))'"
'
}

function SEGMENT_4 { echo '
-draw "line '$((${1}+0))','$((${2}+2))' '$((${1}+0))','$((${2}+6))'"
-draw "line '$((${1}+1))','$((${2}+1))' '$((${1}+1))','$((${2}+7))'"
-draw "line '$((${1}+2))','$((${2}+0))' '$((${1}+2))','$((${2}+8))'"
-draw "line '$((${1}-6))','$((${2}+7))' '$((${1}-2))','$((${2}+7))'"
-draw "line '$((${1}-7))','$((${2}+8))' '$((${1}-1))','$((${2}+8))'"
-draw "line '$((${1}-8))','$((${2}+9))' '$((${1}-2))','$((${2}+9))'"
-draw "line '$((${1}+0))','$((${2}+10))' '$((${1}+0))','$((${2}+14))'"
-draw "line '$((${1}+1))','$((${2}+9))' '$((${1}+1))','$((${2}+15))'"
-draw "line '$((${1}+2))','$((${2}+8))' '$((${1}+2))','$((${2}+16))'"
-draw "line '$((${1}-8))','$((${2}+2))' '$((${1}-8))','$((${2}+6))'"
-draw "line '$((${1}-9))','$((${2}+1))' '$((${1}-9))','$((${2}+7))'"
-draw "line '$((${1}-10))','$((${2}+0))' '$((${1}-10))','$((${2}+8))'"
'
}

function SEGMENT_5 { echo '
-draw "line '$((${1}-6))','$((${2}+7))' '$((${1}-0))','$((${2}+7))'"
-draw "line '$((${1}-7))','$((${2}+8))' '$((${1}-1))','$((${2}+8))'"
-draw "line '$((${1}-8))','$((${2}+9))' '$((${1}-2))','$((${2}+9))'"
-draw "line '$((${1}+0))','$((${2}+10))' '$((${1}+0))','$((${2}+14))'"
-draw "line '$((${1}+1))','$((${2}+9))' '$((${1}+1))','$((${2}+15))'"
-draw "line '$((${1}+2))','$((${2}+8))' '$((${1}+2))','$((${2}+16))'"
-draw "line '$((${1}-7))','$((${2}+15))' '$((${1}-2))','$((${2}+15))'"
-draw "line '$((${1}-8))','$((${2}+16))' '$((${1}-1))','$((${2}+16))'"
-draw "line '$((${1}-9))','$((${2}+17))' '$((${1}-0))','$((${2}+17))'"
-draw "line '$((${1}-8))','$((${2}+2))' '$((${1}-8))','$((${2}+6))'"
-draw "line '$((${1}-9))','$((${2}+1))' '$((${1}-9))','$((${2}+7))'"
-draw "line '$((${1}-10))','$((${2}+0))' '$((${1}-10))','$((${2}+8))'"
-draw "line '$((${1}-6))','$((${2}+1))' '$((${1}-1))','$((${2}+1))'"
-draw "line '$((${1}-7))','$((${2}+0))' '$((${1}-0))','$((${2}+0))'"
-draw "line '$((${1}-8))','$((${2}-1))' '$((${1}+1))','$((${2}-1))'"
'
}

function SEGMENT_6 { echo '
-draw "line '$((${1}-6))','$((${2}+7))' '$((${1}-0))','$((${2}+7))'"
-draw "line '$((${1}-7))','$((${2}+8))' '$((${1}-1))','$((${2}+8))'"
-draw "line '$((${1}-6))','$((${2}+9))' '$((${1}-2))','$((${2}+9))'"
-draw "line '$((${1}+0))','$((${2}+10))' '$((${1}+0))','$((${2}+14))'"
-draw "line '$((${1}+1))','$((${2}+9))' '$((${1}+1))','$((${2}+15))'"
-draw "line '$((${1}+2))','$((${2}+8))' '$((${1}+2))','$((${2}+16))'"
-draw "line '$((${1}-6))','$((${2}+15))' '$((${1}-2))','$((${2}+15))'"
-draw "line '$((${1}-7))','$((${2}+16))' '$((${1}-1))','$((${2}+16))'"
-draw "line '$((${1}-8))','$((${2}+17))' '$((${1}-0))','$((${2}+17))'"
-draw "line '$((${1}-8))','$((${2}+10))' '$((${1}-8))','$((${2}+14))'"
-draw "line '$((${1}-9))','$((${2}+9))' '$((${1}-9))','$((${2}+15))'"
-draw "line '$((${1}-10))','$((${2}+8))' '$((${1}-10))','$((${2}+16))'"
-draw "line '$((${1}-8))','$((${2}+2))' '$((${1}-8))','$((${2}+6))'"
-draw "line '$((${1}-9))','$((${2}+1))' '$((${1}-9))','$((${2}+7))'"
-draw "line '$((${1}-10))','$((${2}+0))' '$((${1}-10))','$((${2}+8))'"
-draw "line '$((${1}-6))','$((${2}+1))' '$((${1}-1))','$((${2}+1))'"
-draw "line '$((${1}-7))','$((${2}+0))' '$((${1}-0))','$((${2}+0))'"
-draw "line '$((${1}-8))','$((${2}-1))' '$((${1}+1))','$((${2}-1))'"
'
}

function SEGMENT_7 { echo '
-draw "line '$((${1}+0))','$((${2}+2))' '$((${1}+0))','$((${2}+6))'"
-draw "line '$((${1}+1))','$((${2}+1))' '$((${1}+1))','$((${2}+7))'"
-draw "line '$((${1}+2))','$((${2}+0))' '$((${1}+2))','$((${2}+8))'"
-draw "line '$((${1}+0))','$((${2}+10))' '$((${1}+0))','$((${2}+14))'"
-draw "line '$((${1}+1))','$((${2}+9))' '$((${1}+1))','$((${2}+15))'"
-draw "line '$((${1}+2))','$((${2}+8))' '$((${1}+2))','$((${2}+16))'"
-draw "line '$((${1}-7))','$((${2}+1))' '$((${1}-2))','$((${2}+1))'"
-draw "line '$((${1}-8))','$((${2}+0))' '$((${1}-1))','$((${2}+0))'"
-draw "line '$((${1}-9))','$((${2}-1))' '$((${1}-0))','$((${2}-1))'"
'
}

function SEGMENT_8 { echo '
-draw "line '$((${1}+0))','$((${2}+2))' '$((${1}+0))','$((${2}+6))'"
-draw "line '$((${1}+1))','$((${2}+1))' '$((${1}+1))','$((${2}+7))'"
-draw "line '$((${1}+2))','$((${2}+0))' '$((${1}+2))','$((${2}+8))'"
-draw "line '$((${1}-6))','$((${2}+7))' '$((${1}-2))','$((${2}+7))'"
-draw "line '$((${1}-7))','$((${2}+8))' '$((${1}-1))','$((${2}+8))'"
-draw "line '$((${1}-6))','$((${2}+9))' '$((${1}-2))','$((${2}+9))'"
-draw "line '$((${1}+0))','$((${2}+10))' '$((${1}+0))','$((${2}+14))'"
-draw "line '$((${1}+1))','$((${2}+9))' '$((${1}+1))','$((${2}+15))'"
-draw "line '$((${1}+2))','$((${2}+8))' '$((${1}+2))','$((${2}+16))'"
-draw "line '$((${1}-6))','$((${2}+15))' '$((${1}-2))','$((${2}+15))'"
-draw "line '$((${1}-7))','$((${2}+16))' '$((${1}-1))','$((${2}+16))'"
-draw "line '$((${1}-8))','$((${2}+17))' '$((${1}-0))','$((${2}+17))'"
-draw "line '$((${1}-8))','$((${2}+10))' '$((${1}-8))','$((${2}+14))'"
-draw "line '$((${1}-9))','$((${2}+9))' '$((${1}-9))','$((${2}+15))'"
-draw "line '$((${1}-10))','$((${2}+8))' '$((${1}-10))','$((${2}+16))'"
-draw "line '$((${1}-8))','$((${2}+2))' '$((${1}-8))','$((${2}+6))'"
-draw "line '$((${1}-9))','$((${2}+1))' '$((${1}-9))','$((${2}+7))'"
-draw "line '$((${1}-10))','$((${2}+0))' '$((${1}-10))','$((${2}+8))'"
-draw "line '$((${1}-6))','$((${2}+1))' '$((${1}-2))','$((${2}+1))'"
-draw "line '$((${1}-7))','$((${2}+0))' '$((${1}-1))','$((${2}+0))'"
-draw "line '$((${1}-8))','$((${2}-1))' '$((${1}-0))','$((${2}-1))'"
'
}

function SEGMENT_9 { echo '
-draw "line '$((${1}+0))','$((${2}+2))' '$((${1}+0))','$((${2}+6))'"
-draw "line '$((${1}+1))','$((${2}+1))' '$((${1}+1))','$((${2}+7))'"
-draw "line '$((${1}+2))','$((${2}+0))' '$((${1}+2))','$((${2}+8))'"
-draw "line '$((${1}-6))','$((${2}+7))' '$((${1}-2))','$((${2}+7))'"
-draw "line '$((${1}-7))','$((${2}+8))' '$((${1}-1))','$((${2}+8))'"
-draw "line '$((${1}-8))','$((${2}+9))' '$((${1}-2))','$((${2}+9))'"
-draw "line '$((${1}+0))','$((${2}+10))' '$((${1}+0))','$((${2}+14))'"
-draw "line '$((${1}+1))','$((${2}+9))' '$((${1}+1))','$((${2}+15))'"
-draw "line '$((${1}+2))','$((${2}+8))' '$((${1}+2))','$((${2}+16))'"
-draw "line '$((${1}-8))','$((${2}+2))' '$((${1}-8))','$((${2}+6))'"
-draw "line '$((${1}-9))','$((${2}+1))' '$((${1}-9))','$((${2}+7))'"
-draw "line '$((${1}-10))','$((${2}+0))' '$((${1}-10))','$((${2}+8))'"
-draw "line '$((${1}-6))','$((${2}+1))' '$((${1}-2))','$((${2}+1))'"
-draw "line '$((${1}-7))','$((${2}+0))' '$((${1}-1))','$((${2}+0))'"
-draw "line '$((${1}-8))','$((${2}-1))' '$((${1}-0))','$((${2}-1))'"
'
}

function SP_2 { echo '
-draw "line '$((${1}+0))','$((${2}+2))' '$((${1}+0))','$((${2}+3))'"
-draw "line '$((${1}+1))','$((${2}+2))' '$((${1}+1))','$((${2}+3))'"
-draw "line '$((${1}+2))','$((${2}+2))' '$((${1}+2))','$((${2}+3))'"
-draw "line '$((${1}+0))','$((${2}+4))' '$((${1}+2))','$((${2}+4))'"
'
}

function DP_2 { echo '
-draw "line '$((${1}+0))','$((${2}+2))' '$((${1}+0))','$((${2}+3))'"
-draw "line '$((${1}+1))','$((${2}+2))' '$((${1}+1))','$((${2}+3))'"
-draw "line '$((${1}+2))','$((${2}+2))' '$((${1}+2))','$((${2}+3))'"
-draw "line '$((${1}+0))','$((${2}+4))' '$((${1}+2))','$((${2}+4))'"
-draw "line '$((${1}+1))','$((${2}+8))' '$((${1}+1))','$((${2}+10))'"
-draw "line '$((${1}+0))','$((${2}+8))' '$((${1}+0))','$((${2}+10))'"
-draw "line '$((${1}+2))','$((${2}+8))' '$((${1}+2))','$((${2}+10))'"
'
}


while true
do
clear 
echo ""
echo ""
get_time


function draw_1 {
SEGMENT_${get_time_2:0:1} 40 14
SEGMENT_${get_time_2:1:1} 55 14
DP_2 60 16
SEGMENT_${get_time_2:3:1} 75 14
SEGMENT_${get_time_2:4:1} 90 14
DP_2 95 16
SEGMENT_${get_time_2:6:1} 110 14
SEGMENT_${get_time_2:7:1} 125 14
}

preparams="-size 160x43 xc:white"
postparams=$(echo "$postparams_begin `draw_1`")

function D_write_1 {
eval convert $preparams $postparams  $postparams_end | ./pbm2lpbm > /tmp/g13-0
}

D_write_1

sleep 2
done

